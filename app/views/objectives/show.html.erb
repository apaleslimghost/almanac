<% content_for :card_nav do %>
   <%= link_to 'Edit', edit_polymorphic_path([@campaign, @card.specific]) %>
<% end %>

<% content_for :header do %>
    <h2>
        <%= link_to [@card.quest.campaign, @card.quest] do %>
            <% if @card.quest.icon %>
                <i class="<%= @card.quest.icon %>" aria-role="image" aria-label="<%= @card.quest.model_name.human %>"></i>
            <% end %>
            <%= @card.quest.title %>
        <% end %>
    </h2>

    <h1>
        <% if @card.icon %>
            <i class="<%= @card.icon %>" aria-role="image" aria-label="<%= @card.specific.model_name.human %>"></i>
        <% end %>

        <%= @card.title %>
    </h1>
<% end %>

<div class="grid">
    <% unless @card.html_body.empty? %>
        <div class="paper">
            <%= @card.html_body %>
        </div>
    <% end %>

    <%= render @card.links_to_relations.map(&:specific) %>

    <div class="card">
        <%= form_with model: [@campaign, @card.card, Link.new(from: @card)] do |f| %>
            <%= f.hidden_field :from_id %>
            <%= f.collection_select :to_id, @campaign.cards.to_a.reject { |c| c.specific == @card }, :id, :title %>
            <%= f.select :link_type, Link.types.each_with_index.map { |type, index| [type.capitalize, type] } %>
            <%= f.submit %>
        <% end %>
    </div>
</div>
